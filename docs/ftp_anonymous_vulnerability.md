# FTP Anonymous Login Vulnerability

## Overview

FTP Anonymous Login is a critical security vulnerability that allows unauthorized access to file systems through the File Transfer Protocol (FTP) without requiring valid credentials. This vulnerability is commonly found in misconfigured FTP servers and can lead to severe information disclosure and potential system compromise.

## What is FTP Anonymous Login?

FTP Anonymous Login occurs when an FTP server is configured to allow access using:
- Username: `anonymous` or `ftp`
- Password: blank or `anonymous` or `ftp`

When enabled, anyone can connect to the FTP server and access files without authentication, making it a significant security risk.

## Vulnerability Details

### Common Default Credentials
- **Username**: `anonymous`, `ftp`, `guest`
- **Password**: (blank), `anonymous`, `ftp`, `guest`, `email@domain.com`

### Configuration Indicators
In vsftpd configuration (`/etc/vsftpd.conf`):
```bash
anonymous_enable=YES          # Enables anonymous access
anon_root=/path/to/files      # Root directory for anonymous users
anon_upload_enable=YES        # Allows anonymous uploads
anon_mkdir_write_enable=YES   # Allows anonymous directory creation
```

## Attack Vectors

### 1. Information Disclosure
- Access to sensitive configuration files
- Database dumps and backups
- Log files containing sensitive information
- Source code repositories
- User lists and credentials

### 2. Credential Harvesting
- Database connection strings
- API keys and tokens
- SMTP credentials
- SSH private keys
- Application secrets

### 3. Lateral Movement
- Access to internal network information
- Configuration files revealing network topology
- Backup files containing system information
- Logs revealing internal IP addresses

## Real-World Impact

### Case Study: E-commerce Breach
During a penetration test, an attacker discovered:
- Anonymous FTP access on development server
- Database backup files containing customer data
- Configuration files with database credentials
- SMTP settings allowing email spoofing
- Internal network topology information

**Result**: Complete compromise of customer database and email system.

## Detection Methods

### 1. Manual Testing
```bash
# Test anonymous login
ftp target.com 21
# Username: anonymous
# Password: (blank)

# Alternative credentials
ftp target.com 21
# Username: ftp
# Password: ftp
```

### 2. Automated Scanning
```bash
# Using nmap
nmap --script ftp-anon -p 21 target.com

# Using Metasploit
use auxiliary/scanner/ftp/anonymous
set RHOSTS target.com
run
```

### 3. Custom Scripts
```bash
#!/bin/bash
ftp -n target.com 21 << EOF
user anonymous
ls
quit
EOF
```

## Exploitation Steps

### Step 1: Initial Reconnaissance
```bash
# Connect to FTP server
ftp target.com 21

# Test anonymous login
user anonymous
# Password: (blank)
```

### Step 2: Directory Enumeration
```bash
# List directories
ls
cd public
ls
cd ..
cd config
ls
cd ..
cd backups
ls
```

### Step 3: File Download
```bash
# Download sensitive files
binary
get database.conf
get smtp.conf
get backup.sql
get server.log
```

### Step 4: Analysis
- Review downloaded files for credentials
- Identify sensitive information
- Map internal network structure
- Document findings for reporting

## Risk Assessment

### Severity Levels
- **Critical**: Database credentials, API keys, private keys
- **High**: Configuration files, backup data, logs
- **Medium**: Public files, documentation
- **Low**: Readme files, public assets

### Business Impact
- **Financial**: Data breach costs, regulatory fines
- **Reputational**: Customer trust loss, brand damage
- **Operational**: System compromise, service disruption
- **Legal**: Compliance violations, lawsuits

## Mitigation Strategies

### 1. Immediate Actions
```bash
# Disable anonymous access in vsftpd.conf
anonymous_enable=NO
anon_upload_enable=NO
anon_mkdir_write_enable=NO
anon_other_write_enable=NO

# Restart FTP service
systemctl restart vsftpd
```

### 2. Authentication Requirements
- Implement strong user authentication
- Use SFTP/FTPS instead of plain FTP
- Enable two-factor authentication
- Regular password rotation

### 3. Access Controls
- Implement proper file permissions
- Use chroot environments
- Restrict user access to specific directories
- Enable logging and monitoring

### 4. Network Security
- Implement network segmentation
- Use firewalls to restrict access
- Monitor FTP traffic
- Regular security audits

### 5. Alternative Solutions
- **SFTP**: Secure File Transfer Protocol over SSH
- **FTPS**: FTP over SSL/TLS
- **Web-based file sharing**: HTTPS file transfer
- **Cloud storage**: Secure cloud solutions

## Monitoring and Detection

### Log Analysis
```bash
# Monitor FTP logs
tail -f /var/log/vsftpd.log

# Look for anonymous access attempts
grep "anonymous" /var/log/vsftpd.log
grep "ftp" /var/log/vsftpd.log
```

### Intrusion Detection
- Configure IDS/IPS rules for FTP
- Monitor for unusual file access patterns
- Alert on anonymous login attempts
- Track file download activities

## Compliance and Standards

### Regulatory Requirements
- **GDPR**: Data protection and privacy
- **PCI DSS**: Payment card security
- **SOX**: Financial reporting security
- **HIPAA**: Healthcare data protection

### Security Frameworks
- **NIST Cybersecurity Framework**
- **ISO 27001 Information Security**
- **CIS Controls**
- **OWASP Top 10**

## Reporting Template

### Executive Summary
- Vulnerability description
- Business impact assessment
- Risk level classification
- Recommended actions

### Technical Details
- Affected systems
- Exploitation method
- Evidence of compromise
- Remediation steps

### Remediation Plan
- Immediate actions
- Short-term fixes
- Long-term improvements
- Timeline and resources

## Tools and Resources

### Testing Tools
- **Nmap**: Network scanning
- **Metasploit**: Exploitation framework
- **Hydra**: Password brute forcing
- **Custom scripts**: Automated testing

### Security Resources
- **CVE Database**: Known vulnerabilities
- **Security Advisories**: Vendor notifications
- **Penetration Testing Guides**: Best practices
- **Security Blogs**: Latest threats

## Conclusion

FTP Anonymous Login is a serious security vulnerability that can lead to significant data breaches and system compromise. Organizations must implement proper security controls, regular monitoring, and comprehensive security policies to protect against this threat.

### Key Takeaways
1. **Always disable anonymous FTP access**
2. **Use secure alternatives (SFTP/FTPS)**
3. **Implement proper authentication**
4. **Regular security assessments**
5. **Monitor and log all access**

### Next Steps
1. Conduct security audit of all FTP servers
2. Implement recommended mitigations
3. Train staff on security best practices
4. Establish monitoring and alerting
5. Regular penetration testing

---

**Note**: This documentation is for educational purposes. Always obtain proper authorization before testing systems for vulnerabilities. 